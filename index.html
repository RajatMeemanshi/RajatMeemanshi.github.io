<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://hv-camera-web-sg.s3-ap-southeast-1.amazonaws.com/hyperverge-web-sdk@5.2.3/src/sdk.min.js"></script>
  </head>
  <body>
    <center><h2>Hyperverge WebSDK Demo</h2></center>
    <div class="container">
      <div class="form-group">
        <center><button type="button" onclick="starOnboarding();" class="btn btn-primary">Run HyperKyc</button>
        <button type="button" onclick="runOCR();" class="btn btn-primary">Run OCR</button></center>
      </div>
      <div id="div1"></div>
    </div>
    <script>
    	function starOnboarding() {
        const accessToken = "Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhcHBJZCI6IjA1ODhkNiIsImhhc2giOiJiZDAxNzgxZWIxYWJhMTUxNDFmYWY0MzY1YTE2ZTllMzAxNWYzMzNmNTQ5M2ZlY2RlYjU3NGYyMzhiMzBjMDZmIiwiaWF0IjoxNjYzNjcyOTk2LCJleHAiOjE2NjM3MDg5OTYsImp0aSI6IjE0YjJhZDQzLTkyY2UtNGQ4NS1iMDI3LTliNzFkYmExNWEzYyJ9.gDu8pH6LcsRxVo3GSZw-dtFZ03koXLYc6YV7_aHc105-9ynBcHZjqKwPLXsXSC87pmN39fWylSs4YTtJwzmcfvR8Pi28_PKHmiTYmu33LQI21Ua_QkXSril15aB1upaHu4c6t-MEgB7aWUfjqnjyDmNxiLQ72rGDn3L8SF63xo0"
        //const base64String = "";
//         const hyperKycConfig = new HyperKycConfig(
//             accessToken,
//             "mezesse_test_workflow",
//             "testing-mezesse-noOCR"
//         );
        
//        
        HyperSnapSDK.init(accessToken, HyperSnapParams.Region.India);
        HyperSnapSDK.startUserSession();
        runLiveness();
  
    }
    const handler = (HyperKycResult) => {
        console.log(HyperKycResult)
        //HyperKycResult.Status - for all statuses going forward from 5.2.0
//         if (HyperKycResult.Cancelled) {
//           // user cancelled
//            console.log(HyperKycResult.Cancelled);
//         } else if (HyperKycResult.Failure) {
//           // failure
//             console.log(HyperKycResult.Failure);
//         } else if (HyperKycResult.Success) {
//           // success
//             console.log(HyperKycResult.Success);
//         }
    }
      function runLiveness(){
      //For Face Capture Screen
        var hvFaceConfig = new HVFaceConfig(); // First create a hvFace config object
        hvFaceConfig.setShouldShowInstructionPage(true);
        hvFaceConfig.setLivenessAPIParameters({
          rejectFaceMask: 'yes',
          allowEyesClosed: 'no',
          allowMultipleFaces: 'no',
          rejectBlur: 'yes',
        });
        
        
    
    //callback for Selfie     
    callback = (HVError, HVResponse) => {
          if(HVError) {
            var errorCode = HVError.getErrorCode();
            var errorMessage = HVError.getErrorMessage();
          } 
          else if(HVResponse) {
            var apiResults = HVResponse.getApiResult();
            var apiHeaders = HVResponse.getApiHeaders();
            faceImageBase64 = HVResponse.getImageBase64();
            var attempts = HVResponse.getAttemptsCount();
          }
        };
        HVFaceModule.start(hvFaceConfig, callback);// Start the HVFaceModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
        //faceImageBase64String = imageBase64;
      }
      
     // Function wrapper for documents button
     function runOCR(){ // Hopefully this 1 function should do both front and back for documents
    
         //For Document Back Capture Screen
        hvDocConfig = new HVDocConfig(); // First create a hvdoc config object
        hvDocConfig.setOCRDetails(
          'https://ind-docs.hyperverge.co/v2.0/readKYC',
          hvDocConfig.DocumentSide.BACK,
          {},
          {},
        );
        hvDocConfig.setShouldShowDocReviewScreen(true);
        hvDocConfig.docTextConfig.setDocCaptureTitle('Capture Back of ID Card');
        HVDocsModule.start(hvDocConfig, callback); // Start the HVDocsModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
         
    //For Doc Front Capture Screen       
    hvDocConfig = new HVDocConfig();
        hvDocConfig.setOCRDetails(
          'https://ind-docs.hyperverge.co/v2.0/readKYC',
          hvDocConfig.DocumentSide.FRONT,
          { },
          { },
        );
        hvDocConfig.setShouldShowInstructionPage(true);
        hvDocConfig.setShouldShowDocReviewScreen(true);
    hvDocConfig.setChooseDocumentCaptureOption(true);
    hvDocConfig.docTextConfig.setDocCaptureTitle('Capture Front of ID Card');
    
    HVDocsModule.start(hvDocConfig, callback); // Start the HVDocsModule. Callback is the function that receives the data once the api call finishes.It gets two objects HVError and HVResponse.
    //docImageBase64String = imageBase64;
         
    //Define Callback function for Document OCR
         
    callback = (HVError, HVResponse) => {
          if(HVError) {
            var errorCode = HVError.getErrorCode();
            var errorMessage = HVError.getErrorMessage();
          } 
          else if(HVResponse) {
            var apiResults = HVResponse.getApiResult();
            var apiHeaders = HVResponse.getApiHeaders();
            docImageBase64 = HVResponse.getImageBase64();
            var attempts = HVResponse.getAttemptsCount();
          }
        };
    }
      
    </script>
  </body>
</html>   
